<!DOCTYPE html>
<html>
<head>
	<title>Sorting and Filtering</title>
	<meta charset="utf-8">
	<link href="{{@TELERIK}}web/telerik/content/shared/styles/examples-offline.css" rel="stylesheet">
	<link href="{{@TELERIK}}web/telerik/styles/kendo.common.min.css" rel="stylesheet">
	<link href="{{@TELERIK}}web/telerik/styles/kendo.rtl.min.css" rel="stylesheet">
	<link href="{{@TELERIK}}web/telerik/styles/kendo.default.min.css" rel="stylesheet">
	<link href="{{@TELERIK}}web/telerik/styles/kendo.default.mobile.min.css" rel="stylesheet">
	<script src="{{@TELERIK}}web/telerik/js/jquery.min.js"></script>
	<script src="{{@TELERIK}}web/telerik/js/jszip.min.js"></script>
	<script src="{{@TELERIK}}web/telerik/js/kendo.all.min.js"></script>
	<script src="{{@TELERIK}}web/telerik/content/shared/js/console.js"></script>
</head>
<body>

<a class="offline-button" href="../index.html">Volver</a>

<div id="example">
	<div id="spreadsheet" style="width: 100%"></div>

    <script>
        /*var dataSource = new kendo.data.DataSource({
            transport: {
                read: {
                    url: "ajax_simulador_cbx/llenar_tabla2",
                    dataType: "json"
                }
            }

        });

        dataSource.read().then(function() {
            var view = dataSource.view();
            console.log(view);
        });*/
    </script>


    <script>
       /* $(function() {

            var crudServiceBaseUrl = "ajax_simulador_cbx/llenar_tabla2_telerik";
            // crudServiceBaseUrl JSON Returns data on this format (Just 1 column query example):  [{"ID_COLOR3":"MANGA CORTA","0":"MANGA CORTA"},{"ID_COLOR3":"MANGA CORTA","0":"MANGA CORTA"}

            var dataSource = new kendo.data.DataSource({
                transport: {
                    read: onRead,
                    submit: onSubmit
                },
                batch: true,
                change: function() {
                    $("#cancel, #save").toggleClass("k-state-disabled", !this.hasChanges());
                },
                schema: {
                    //data: "JSONDataResult",
                    parse: function(response) {
                        console.log("parse");
                        console.log(JSON.stringify(response, null, 4));
                        debugger;
                        return response.JSONDataResult;
                    },
                    model: {
                        id: "ID_COLOR3",
                        fields: {
                            ID_COLOR3: { type: "string" }
                        }
                    }
                }
            });


            $("#spreadsheet").kendoSpreadsheet({
                columns: 20,
                rows: 10,
                toolbar: true,
                sheetsbar: false,
                sheets: [{
                    name: "Products",
                    dataSource: dataSource,
                    rows: [{
                        height: 40,
                        cells: [
                            {
                                bold: "true",
                                background: "#9c27b0",
                                textAlign: "center",
                                color: "white"
                            },{
                                bold: "true",
                                background: "#9c27b0",
                                textAlign: "center",
                                color: "white"
                            },{
                                bold: "true",
                                background: "#9c27b0",
                                textAlign: "center",
                                color: "white"
                            },{
                                bold: "true",
                                background: "#9c27b0",
                                textAlign: "center",
                                color: "white"
                            },{
                                bold: "true",
                                background: "#9c27b0",
                                textAlign: "center",
                                color: "white"
                            }]
                    }],
                    columns: [
                        { width: 100 },
                        { width: 415 },
                        { width: 145 },
                        { width: 145 },
                        { width: 145 }
                    ]
                }]
            });

            function onSubmit(e) {
                $.ajax({
                    url: crudServiceBaseUrl + "",
                    data: { models: kendo.stringify(e.data) },
                    contentType: "application/json",
                    dataType: "json",
                    success: function (result) {
                        e.success(result.Updated, "update");
                        e.success(result.Created, "create");
                        e.success(result.Destroyed, "destroy");
                    },
                    error: function (xhr, httpStatusMessage, customErrorMessage) {
                        alert(xhr.responseText);
                    }
                });
            }

            function onRead(options) {
                $.ajax({
                    url: crudServiceBaseUrl + "",
                    dataType: "json",
                    success: function (result) {
                        options.success(result);
                    },
                    error: function (result) {
                        options.error(result);
                    }
                });
            }

            $("#save").click(function() {
                if (!$(this).hasClass("k-state-disabled")) {
                    dataSource.sync();
                }
            });

            $("#cancel").click(function() {
                if (!$(this).hasClass("k-state-disabled")) {
                    dataSource.cancelChanges();
                }
            });



        });*/
    </script>


    <script>

        var dataSource = new kendo.data.DataSource({
            transport: {
                read:  {
                    url: "ajax_simulador_cbx/llenar_tabla2_telerik",
                    dataType: "json"
                }
            }
        });

        $("#spreadsheet").kendoSpreadsheet();

        var spreadsheet = $("#spreadsheet").data("kendoSpreadsheet");
        var sheet = spreadsheet.activeSheet();
        //sheet.setDataSource(dataSource, ["ID_COLOR3","GRUPO_COMPRA","COD_TEMP","LINEA","SUBLINEA","MARCA","ESTILO","SHORT_NAME","ID_CORPORATIVO","DESCMODELO","DESCRIP_INTERNET","COMPOSICION","COLECCION","EVENTO","COD_ESTILO_VIDA","CALIDAD","COD_OCASION_USO","COD_PIRAMIX","DESCRIPCION","COD_RANKVTA","LIFE_CYCLE","NOM_COLORCOD_COLOR","TIPO_PRODUCTO","TIPO_EXHIBICION","DESTALLA","TIPO_EMPAQUE","PORTALLA_1_INI","PORTALLA_1","CURVATALLA","CURVAMIN","UNID_OPCION_INICIO","UNID_OPCION_AJUSTADA","UNIDADESCAN","MTR_PACK","CANT_INNER","SEG_ASIG","FORMATO","TDAS","A","B","C","I","UND_ASIG_INI","ROT","NOM_PRECEDENCIA","NOM_VIA","NOM_PAIS","VIAJE","MKUP","PRECIO_BLANCO","GM","COD_TIP_MON","COSTO_TARGET","COSTO_FOB","COSTO_INSP","COSTO_RFID","ROYALTY_POR","COSTO_UNIT","COSTO_UNITS","CST_TOTLTARGET","COSTO_TOT","COSTO_TOTS","RETAIL","DEBUT_REODER","SEM_INI","SEM_FIN","CICLO","AGOT_OBJ","SEMLIQ","ALIAS_PROV","COD_PROVEEDOR","COD_TRADER","CODSKUPROVEEDOR","COD_PADRESKU","PROFORMA","ARCHIVO","ESTILO_PMM","ESTADO_MATCH","PO_NUMBER","ESTADO_OC","FECHA_EMBARQUE","FECHA_ETA","FECHA_RECEPCION","DIAS_ATRASO","CODESTADO","ESTADO_C1","VENTANA_LLEGADA","FECHA_RECEPCD_C1" ]);
        // Forma 1: sheet.setDataSource(dataSource);
        // Forma 2: sheet.setDataSource(dataSource, ["","CURVATALLA","CURVAMIN","UNID_OPCION_INICIO","UNID_OPCION_AJUSTADA","UNIDADESCAN","MTR_PACK","CANT_INNER","SEG_ASIG","FORMATO","TDAS","A","B","C","I","UND_ASIG_INI","ROT","NOM_PRECEDENCIA","NOM_VIA","NOM_PAIS","VIAJE","MKUP","PRECIO_BLANCO","GM","COD_TIP_MON","COSTO_TARGET","COSTO_FOB","COSTO_INSP","COSTO_RFID","ROYALTY_POR","COSTO_UNIT","COSTO_UNITS","CST_TOTLTARGET","COSTO_TOT","COSTO_TOTS","RETAIL","DEBUT_REODER","SEM_INI","SEM_FIN","CICLO","AGOT_OBJ","SEMLIQ","ALIAS_PROV","COD_PROVEEDOR","COD_TRADER","CODSKUPROVEEDOR","COD_PADRESKU","PROFORMA","ARCHIVO","ESTILO_PMM","ESTADO_MATCH","PO_NUMBER","ESTADO_OC","FECHA_EMBARQUE","FECHA_ETA","FECHA_RECEPCION","DIAS_ATRASO","CODESTADO","ESTADO_C1","VENTANA_LLEGADA","FECHA_RECEPCD_C1"]);

        sheet.setDataSource(dataSource, [
            { field: "ID_COLOR3", title: "ID" },
            { field: "GRUPO_COMPRA", title: "G. Compra" },
            { field: "COD_TEMP", title: "Temp" },
            { field: "LINEA", title: "Línea" },
            { field: "SUBLINEA", title: "SubLínea" },
            { field: "MARCA", title: "Marca" },
            { field: "ESTILO", title: "Estilo" },
            { field: "SHORT_NAME", title: "Estilo Corto" },
            { field: "ID_CORPORATIVO", title: "Cod. Corp." },
            { field: "DESCMODELO", title: "Descripción" },
            { field: "DESCRIP_INTERNET", title: "Desc. Internet" },
            { field: "COMPOSICION", title: "Composición" },
            { field: "COLECCION", title: "Colección" },
            { field: "EVENTO", title: "Evento" },
            { field: "COD_ESTILO_VIDA", title: "Estilo Vida" },
            { field: "CALIDAD", title: "Calidad" },
            { field: "COD_OCASION_USO", title: "Ocación Uso" },
            { field: "COD_PIRAMIX", title: "Piramide Mix" },
            { field: "DESCRIPCION", title: "Ventana" },
            { field: "COD_RANKVTA", title: "Rank. Venta" },
            { field: "LIFE_CYCLE", title: "Ciclo Vida" },
            { field: "NUM_EMB", title: "Num. Opción" },
            { field: "COD_COLOR", title: "Color" },
            // BTN Hist
            { field: "TIPO_PRODUCTO", title: "Tipo Producto" },
            { field: "TIPO_EXHIBICION", title: "Tipo Exhibición" },
            { field: "DESTALLA", title: "Talla" },
            { field: "TIPO_EMPAQUE", title: "Tipo Empaque" },
            { field: "PORTALLA_1_INI", title: "% Compra Ini." },
            { field: "PORTALLA_1", title: "% Compra Ajust." },
            // BTN Ajuste Compra
            { field: "CURVATALLA", title: "Curva" },
            { field: "CURVAMIN", title: "Curva Min." },
            { field: "UNID_OPCION_INICIO", title: "Uni Ini" },
            { field: "UNID_OPCION_AJUSTADA", title: "Uni Ajust" },
            { field: "UNIDADESCAN", title: "Uni Final" },
            { field: "MTR_PACK", title: "MtrPack" },
            { field: "CANT_INNER", title: "Nro Cajas" },
            { field: "SEG_ASIG", title: "Cluster" },
            { field: "FORMATO", title: "Formato" },
            { field: "TDAS", title: "Tienda" },
            { field: "A", title: "A" },
            { field: "B", title: "B" },
            { field: "C", title: "C" },
            { field: "I", title: "I" },
            { field: "UND_ASIG_INI", title: "Primera Carga" },
            { field: "ROT", title: "% Tienda" },
            { field: "NOM_PRECEDENCIA", title: "Proced" },
            { field: "NOM_VIA", title: "Vía" },
            { field: "NOM_PAIS", title: "País" },
            { field: "VIAJE", title: "Viaje" },
            { field: "MKUP", title: "Mkup" },
            { field: "PRECIO_BLANCO", title: "Precio Blanco" },
            { field: "OFERTA", title: "Oferta" },
            { field: "GM", title: "GM" },
            { field: "COD_TIP_MON", title: "Moneda" },
            { field: "COSTO_TARGET", title: "Target" },
            { field: "COSTO_FOB", title: "FOB" },
            { field: "COSTO_INSP", title: "Insp" },
            { field: "COSTO_RFID", title: "RFID" },
            { field: "ROYALTY_POR", title: "Royalty(%)" },
            { field: "COSTO_UNIT", title: "Costo Unitario Final US$" },
            { field: "COSTO_UNITS", title: "Costo Unitario Final Pesos" },
            { field: "CST_TOTLTARGET", title: "Total Target US$" },
            { field: "COSTO_TOT", title: "Total FOB US$" },
            { field: "COSTO_TOTS", title: "Costo Total Pesos" },
            { field: "RETAIL", title: "Total Retail Pesos (Sin IVA)" },
            { field: "DEBUT_REODER", title: "Debut / Reorder" },
            { field: "SEM_INI", title: "Sem. Ini." },
            { field: "SEM_FIN", title: "Sem. Fin" },
            { field: "CICLO", title: "Semanas Ciclo Vida" },
            { field: "AGOT_OBJ", title: "Agot. Obj." },
            { field: "SEMLIQ", title: "Semanas Liquidación" },
            { field: "ALIAS_PROV", title: "Proveedor" },
            { field: "COD_PROVEEDOR", title: "Razón Social" },
            { field: "COD_TRADER", title: "Trader" },
            { field: "CODSKUPROVEEDOR", title: "Cod. SKU Proveedor" },
            { field: "COD_PADRESKU", title: "Cod. Padre" },
            { field: "PROFORMA", title: "Proforma" },
            // BTN D
            { field: "ARCHIVO", title: "Archivo" },
            // Btn PI
            { field: "ESTILO_PMM", title: "Estilo PMM" },
            { field: "ESTADO_MATCH", title: "Estado Match" },
            { field: "PO_NUMBER", title: "Nº OC" },
            { field: "ESTADO_OC", title: "Estado OC" },
            { field: "FECHA_EMBARQUE", title: "Fecha Embarque" },
            { field: "FECHA_ETA", title: "Fecha ETA" },
            { field: "FECHA_RECEPCION", title: "Fecha Recepción CD" },
            { field: "DIAS_ATRASO", title: "Días Atraso CD" },
            { field: "CODESTADO", title: "Estado Opción" },
            { field: "ESTADO_C1", title: "ESTADO_C1" },
            { field: "VENTANA_LLEGADA", title: "VENTANA_LLEGADA" },
            { field: "FECHA_RECEPCD_C1", title: "FECHA_RECEPCD_C1" }
        ]);






    </script>





</div>


</body>
</html>


</div>



</body>
</html>